<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.action.system.mapper.SysDataRowLimitMapper">

    <select id="getUserDataRowPerm" resultType="com.action.system.entity.SysDataRowLimit">
        select sdrl.id,
            sdrl.data_id,
            sdrl.type,
            sdrl.contact_id,
            sdrl.condition,
            sdrl.limit_type,
            sdrl.limit_field,
            sdrl.limit_field_desc,
            sdrl.val,
            sdrl.status,
            sdrl.create_by,
            sdrl.create_time,
            sdrl.update_by,
            sd.table_name
        from sys_data_row_limit sdrl
        left join sys_data sd on sd.id = scl.data_id
        where 1=1
        or (
        sdrl.type = 1 and sdrl.contact_id in
        <foreach collection="groupIdSet" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
        )
        or ( sdrl.type = 2 and sdrl.contact_id in
        <foreach collection="postIdSet" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
        )
        or ( sdrl.type = 3 and sdrl.contact_id in
        <foreach collection="roleIdSet" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
        )
    </select>

</mapper>
